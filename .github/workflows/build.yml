name: Build AHK Executable

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build-exe:
    runs-on: windows-latest

    steps:
      - name: 1. Checkout Repository Code
        uses: actions/checkout@v4

      - name: 2. Compile AHK Script
        id: compile  #  هذا المعرّف مهم للخطوة التالية
        uses: ./.github/actions/ahk-compiler
        with:
          script_file: 'Playback.ahk'
          output_file: 'release/Playback.exe'
          icon_file: 'play_pause_icon_137298.ico'
          architecture: 'x64'

      - name: 3. Upload Compiled Executable
        uses: actions/upload-artifact@v4
        with:
          name: Playback-App
          path: ${{ steps.compile.outputs.exe_path }} # هنا يقرأ المسار من الخطوة السابقة