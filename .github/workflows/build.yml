# .github/workflows/build.yml

name: Build AHK Executable

on:
  push:
    branches: [ "main" ]
  workflow_dispatch: # Allows you to run this workflow manually from the Actions tab

jobs:
  build-exe:
    runs-on: windows-latest

    steps:
      # Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø¬Ù„Ø¨ ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¡
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: ğŸ§ List all files to verify paths
        run: |
            Write-Host "--- Listing all files recursively ---"
            ls -R
            Write-Host "-------------------------------------"
        shell: pwsh        
        
      # Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø£ÙƒØ´Ù† Ø§Ù„Ù…Ø­Ù„ÙŠ Ø§Ù„Ø°ÙŠ Ø£Ù†Ø´Ø£ØªÙ‡
      - name: Compile AHK Script
        id: compile
        uses: ./.github/actions/ahk-compiler # Ø§Ù„Ù…Ø³Ø§Ø± Ø¥Ù„Ù‰ Ù…Ù„Ù action.yml
        with:
          script_file: 'Playback.ahk'
          output_file: 'release\Playback.exe'
          icon_file: 'play_pause_icon_137298.ico' # Ù‚Ù… Ø¨Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ù…Ù„Ù Ø£ÙŠÙ‚ÙˆÙ†Ø©
          architecture: 'x64' # ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† 'x86' Ø£Ùˆ 'x64'

      # Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø·Ø¨Ø§Ø¹Ø© Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†Ø§ØªØ¬ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      - name: Print output path
        run: echo "Compiled file is at ${{ steps.compile.outputs.exe_path }}"
      
      # Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†Ø§ØªØ¬ ÙƒÙ€ "artifact" Ù„ØªØªÙ…ÙƒÙ† Ù…Ù† ØªØ­Ù…ÙŠÙ„Ù‡
      - name: Upload Executable Artifact
        uses: actions/upload-artifact@v4
        with:
          name: my-ahk-app-x64
          path: ${{ steps.compile.outputs.exe_path }}